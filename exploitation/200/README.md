# Exploitation - Exploitation 2 - 200 Points  

## Challenge site  

nc 128.238.66.212 31338  
exploit2  

## Server output  

Welcome to CSAW CTF.  Exploitation 2 will be a little harder this year.  Insert your exploit here:  

## Notes  

	$ file exploit2  
	exploit2: ELF 32-bit LSB  executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, BuildID[sha1]=94f196c7d8ce45ecf9943690ed4e193c9d13b906, not stripped  

	gdb example to spot buffer overrun:
	------------------------------------
	$ gdb exploit2
	(gdb) set follow-fork-mode child
	(gdb) break *0x80488f5
	(gdb) run
	$ python -c "print('A'*3000)" | nc localhost 31338
	hit at breakpoint 0x80488f5
	(gdb) next
	frame 1 # <- if you overran you should see your pattern (example: 0x41414141)
	
	
	Things i have learned.
	The stack frame pattern is at offset 2064
	but there is a stack cookie at offset 2048
	The garbage at the begining of the message (ie; ',uyye!w-Welcome to CSAW CTF. ') is not just crap. 
	    at offset 4 is the stack cookie (4 byte integer big endian).
	That stack cookie can also be read out of memory in GDB at memory offset 0x804a074
	
	
